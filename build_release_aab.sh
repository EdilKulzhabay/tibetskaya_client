#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è release AAB (Android App Bundle) –¥–ª—è Google Play
# –í–µ—Ä—Å–∏—è: 1.0.0

echo "üöÄ –ù–∞—á–∏–Ω–∞—é —Å–±–æ—Ä–∫—É release AAB —Ñ–∞–π–ª–∞..."
echo "üì¶ –í–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: 1.0.0"

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é android
cd android

# –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–±–æ—Ä–∫–∏
echo "üßπ –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–±–æ—Ä–æ–∫..."
./gradlew clean

# –°–æ–±–∏—Ä–∞–µ–º release AAB
echo "üî® –°–±–æ—Ä–∫–∞ release AAB..."
./gradlew bundleRelease

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
if [ $? -eq 0 ]; then
    echo "‚úÖ AAB —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!"
    echo ""
    echo "üìç –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É:"
    echo "   $(pwd)/app/build/outputs/bundle/release/app-release.aab"
    echo ""
    echo "üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ:"
    ls -lh app/build/outputs/bundle/release/app-release.aab
    echo ""
    echo "üéâ –ì–æ—Ç–æ–≤–æ! –§–∞–π–ª –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ Google Play Console."
    echo ""
    echo "üí° –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:"
    echo "   1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Google Play Console"
    echo "   2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"
    echo "   3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª '–†–µ–ª–∏–∑—ã' -> '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ'"
    echo "   4. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ä–µ–ª–∏–∑ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª app-release.aab"
else
    echo "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ AAB —Ñ–∞–π–ª–∞"
    exit 1
fi

cd ..

