# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –∫—É—Ä—å–µ—Ä–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. **API Integration**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `apiService.getCourierLocation(courierId)` –≤ `src/api/services.ts`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–∞—à —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π endpoint `/getCourierLocation`

### 2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**
- ‚úÖ **–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∑–∞–∫–∞–∑–∞** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `order.courierAggregator.point` –∏–∑ API
- ‚úÖ **–ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ **–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç** - –∫–∞—Ä—Ç–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### 3. **–†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "üîÑ –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ" –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –∫—É—Ä—å–µ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω

### 4. **Fallback –ª–æ–≥–∏–∫–∞**
- ‚úÖ –ï—Å–ª–∏ –∫—É—Ä—å–µ—Ä –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- ‚úÖ –ï—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
- ‚úÖ –ï—Å–ª–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ü–µ–Ω—Ç—Ä –ê–ª–º–∞—Ç—ã

## –ö–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### `src/api/services.ts`
```typescript
getCourierLocation: async (courierId: string) => {
  try {
    const response = await api.post('/getCourierLocation', {courierId});
    return response.data;
  } catch (error) {
    throw error;
  }
}
```

### `src/components/OnTheWayView.tsx`
```typescript
// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –∫—É—Ä—å–µ—Ä–∞
const fetchCourierLocation = async () => {
  if (!order.courierAggregator || typeof order.courierAggregator === 'string') {
    return;
  }

  try {
    const courierId = order.courierAggregator._id;
    const response = await apiService.getCourierLocation(courierId);
    
    if (response.point && response.point.lat && response.point.lon) {
      const newLocation = {
        latitude: response.point.lat,
        longitude: response.point.lon
      };
      
      setCurrentCourierLocation(newLocation);
      handleCourierLocationUpdate(newLocation);
    }
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –∫—É—Ä—å–µ—Ä–∞:', error);
  }
};

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
useEffect(() => {
  // ... –ø—Ä–æ–≤–µ—Ä–∫–∏ ...
  
  const interval = setInterval(() => {
    fetchCourierLocation();
  }, 30000); // 30 —Å–µ–∫—É–Ω–¥

  return () => clearInterval(interval);
}, [order._id, order.courierAggregator]);
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É

### –í–∞—à API endpoint `/getCourierLocation`:
```javascript
export const getCourierLocation = async (req, res) => {
    try {
        const { courierId } = req.body;
        const courierAggregator = await CourierAggregator.findById(courierId);
        res.json({ point: courierAggregator.point });
    } catch (error) {
        console.log(error);
        res.status(500).json({
            message: "–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫",
        });
    }
}
```

### –û–∂–∏–¥–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:
```json
{
  "point": {
    "lat": 43.2098,
    "lon": 76.8845,
    "timestamp": "2025-01-15T14:30:00Z"
  }
}
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** - –±–æ–ª—å—à–µ –Ω–∏–∫–∞–∫–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
3. **–†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±–Ω–æ–≤–∏—Ç—å –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
5. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ (–º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å)

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –∏–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ `OnTheWayView.tsx`:
```typescript
const interval = setInterval(() => {
  fetchCourierLocation();
}, 30000); // –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
```

- 15000 = 15 —Å–µ–∫—É–Ω–¥
- 30000 = 30 —Å–µ–∫—É–Ω–¥ (—Ç–µ–∫—É—â–µ–µ)
- 60000 = 1 –º–∏–Ω—É—Ç–∞
