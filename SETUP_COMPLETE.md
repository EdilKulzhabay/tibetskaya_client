# ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∞!

## üìã –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

### 1. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `@react-native-firebase/app` - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Firebase
- `@react-native-firebase/messaging` - –¥–ª—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –í—Å–µ CocoaPods –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

### 2. ‚úÖ –°–æ–∑–¥–∞–Ω —Å–µ—Ä–≤–∏—Å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
–§–∞–π–ª: `src/services/pushNotifications.ts`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ FCM —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–æ–∫–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (—Ñ–æ–Ω–æ–≤—ã–µ –∏ –Ω–∞ –ø–µ—Ä–µ–¥–Ω–µ–º –ø–ª–∞–Ω–µ)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –ø–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

### 3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω AppDelegate.swift
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
- –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–µ–ª–µ–≥–∞—Ç—ã –¥–ª—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ APNs —Ç–æ–∫–µ–Ω–æ–≤

### 4. ‚úÖ –°–æ–∑–¥–∞–Ω entitlements —Ñ–∞–π–ª
–§–∞–π–ª: `ios/tibetskayaClientApp/tibetskayaClientApp.entitlements`
- –ù–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è development –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 5. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω Podfile
- –î–æ–±–∞–≤–ª–µ–Ω `use_frameworks! :linkage => :static` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Firebase

### 6. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ App.tsx
- Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **–ù–ï –ó–ê–ü–£–°–¢–ò–¢–°–Ø** –ø–æ–∫–∞ –≤—ã –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–∏ —à–∞–≥–∏:

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç—å GoogleService-Info.plist

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [Firebase Console](https://console.firebase.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. –î–æ–±–∞–≤—å—Ç–µ iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
   - Bundle ID –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –≤–∞—à–∏–º –≤ Xcode
   - –°–∫–∞—á–∞–π—Ç–µ `GoogleService-Info.plist`
4. –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª:
   ```
   ios/tibetskayaClientApp/GoogleService-Info.plist
   ```

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª –≤ Xcode

```bash
open ios/tibetskayaClientApp.xcworkspace
```

1. –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ `GoogleService-Info.plist` –≤ –ø–∞–ø–∫—É `tibetskayaClientApp` –≤ Xcode
2. **–í–∞–∂–Ω–æ!** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≥–∞–ª–æ—á–∫–∞ —Å—Ç–æ–∏—Ç –Ω–∞ —Ç–∞—Ä–≥–µ—Ç–µ `tibetskayaClientApp`

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Capabilities –≤ Xcode

1. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç ‚Üí —Ç–∞—Ä–≥–µ—Ç `tibetskayaClientApp`
2. –í–∫–ª–∞–¥–∫–∞ **Signing & Capabilities**
3. –ù–∞–∂–º–∏—Ç–µ **+ Capability** –∏ –¥–æ–±–∞–≤—å—Ç–µ:
   - **Push Notifications**
   - **Background Modes** ‚Üí –≤–∫–ª—é—á–∏—Ç–µ **Remote notifications**

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å APNs –≤ Firebase

#### 4.1 –°–æ–∑–¥–∞—Ç—å APNs –∫–ª—é—á:
1. [Apple Developer](https://developer.apple.com/account) ‚Üí **Keys**
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–ª—é—á —Å **APNs** capability
3. –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª `.p8` (—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!)
4. –ó–∞–ø–æ–º–Ω–∏—Ç–µ **Key ID** –∏ **Team ID**

#### 4.2 –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ Firebase:
1. Firebase Console ‚Üí **Project Settings** ‚Üí **Cloud Messaging**
2. **iOS app configuration** ‚Üí **APNs Authentication Key**
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ `.p8`, –≤–≤–µ–¥–∏—Ç–µ Key ID –∏ Team ID

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Bundle ID

Bundle ID –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å:
- Xcode (General ‚Üí Bundle Identifier)
- Firebase Console
- Apple Developer (App ID)
- GoogleService-Info.plist

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:

```bash
npm run ios
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫–æ–Ω—Å–æ–ª–∏:**
```
üîî –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π...
‚úÖ Push notifications authorized
üì± APNs token registered
üì± FCM Token: [–≤–∞—à —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω]
‚úÖ FCM —Ç–æ–∫–µ–Ω –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Firebase Console:

1. Firebase Console ‚Üí **Cloud Messaging**
2. **Send your first message**
3. –í–≤–µ–¥–∏—Ç–µ:
   - **–ó–∞–≥–æ–ª–æ–≤–æ–∫**: "–¢–µ—Å—Ç"
   - **–¢–µ–∫—Å—Ç**: "–¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ"
4. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
5. **–û—Ç–ø—Ä–∞–≤–∏—Ç—å**

### –í–∞–∂–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- ‚úÖ Push —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ **—Ä–µ–∞–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ**
- ‚ùå Push **–ù–ï —Ä–∞–±–æ—Ç–∞—é—Ç** –Ω–∞ —Å–∏–º—É–ª—è—Ç–æ—Ä–µ
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–∫—Ä—ã—Ç–æ –∏–ª–∏ –≤ —Ñ–æ–Ω–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

---

## üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å userId (–≤ useAuth —Ö—É–∫–µ):

```typescript
import pushNotificationService from '../services/pushNotifications';

// –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ª–æ–≥–∏–Ω–∞
pushNotificationService.setUserId(user.id);

// –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ
pushNotificationService.clearToken();
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:

```typescript
const token = pushNotificationService.getToken();
console.log('FCM Token:', token);
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è**: `FIREBASE_SETUP_GUIDE.md`
- **–°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**: `src/services/pushNotifications.ts`
- **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏**: `NEXT_STEPS_PUSH.md`

---

## üîß Troubleshooting

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫—Ä–∞—à–∏—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:
```
Reason: [FIRApp configure]; [...] GoogleService-Info.plist
```
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ `GoogleService-Info.plist` –≤ –ø—Ä–æ–µ–∫—Ç (—Å–º. –®–∞–≥ 1-2)

### FCM —Ç–æ–∫–µ–Ω –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è:
**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- GoogleService-Info.plist –¥–æ–±–∞–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- Bundle ID —Å–æ–≤–ø–∞–¥–∞–µ—Ç –≤–µ–∑–¥–µ
- APNs –∫–ª—é—á –∑–∞–≥—Ä—É–∂–µ–Ω –≤ Firebase
- –ï—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç:
**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- Push Notifications –≤–∫–ª—é—á–µ–Ω—ã –≤ Capabilities
- APNs –∫–ª—é—á –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ Firebase
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (–Ω–µ —Å–∏–º—É–ª—è—Ç–æ—Ä)
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω–æ

### –û—à–∏–±–∫–∏ –ø—Ä–∏ pod install:
```bash
export LANG=en_US.UTF-8
cd ios
rm -rf Pods Podfile.lock
pod install
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:

- [ ] Firebase –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω
- [ ] GoogleService-Info.plist –ø–æ–ª—É—á–µ–Ω –∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –ø—Ä–æ–µ–∫—Ç
- [ ] Capabilities (Push Notifications, Background Modes) –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ Xcode
- [ ] APNs –∫–ª—é—á —Å–æ–∑–¥–∞–Ω –∏ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ Firebase
- [ ] Bundle ID —Å–æ–≤–ø–∞–¥–∞–µ—Ç –≤–µ–∑–¥–µ
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è
- [ ] FCM —Ç–æ–∫–µ–Ω –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è
- [ ] –¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–æ –∫ –ø—Ä–∏–µ–º—É push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π!

**–ù–µ –∑–∞–±—É–¥—å—Ç–µ:** –î–ª—è production –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑–º–µ–Ω–∏—Ç–µ –≤ entitlements:
```xml
<key>aps-environment</key>
<string>production</string>
```

