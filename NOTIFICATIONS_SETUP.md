# üîî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (Android + iOS)

## ‚úÖ –ß—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

### Android
- ‚úÖ –ö–∞–Ω–∞–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π `orders_v2` —Å –≤—ã—Å–æ–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
- ‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–π –∑–≤—É–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ –í–∏–±—Ä–∞—Ü–∏—è
- ‚úÖ –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è POST_NOTIFICATIONS (Android 13+)
- ‚úÖ –ú–∞–ª–µ–Ω—å–∫–∞—è –∏–∫–æ–Ω–∫–∞: `ic_notification.png` (–≤–∞—à–∞ –∏–∫–æ–Ω–∫–∞)
- ‚úÖ –ë–æ–ª—å—à–∞—è –∏–∫–æ–Ω–∫–∞: `notificationIcon.png` (–≤–∞—à–∞ —Ü–≤–µ—Ç–Ω–∞—è –∏–∫–æ–Ω–∫–∞)
- ‚úÖ –¶–≤–µ—Ç –∞–∫—Ü–µ–Ω—Ç–∞: #EE3F58 (—Ä–æ–∑–æ–≤—ã–π)

### iOS
- ‚úÖ Firebase Messaging –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ APNs —Ç–æ–∫–µ–Ω—ã —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–π –∑–≤—É–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ Badge (–∑–Ω–∞—á–æ–∫ –Ω–∞ –∏–∫–æ–Ω–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–æ –≤–ª–æ–∂–µ–Ω–∏–∏: `notificationIcon.png`
- ‚úÖ –í–∞–∂–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è (timeSensitive)
- ‚úÖ –§–æ–Ω–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (remote-notification)

## üì¶ –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### Android
```
android/app/src/main/AndroidManifest.xml
android/app/src/main/java/com/tibetskayaclientapp/MainApplication.kt
android/app/src/main/res/drawable/ic_notification.png
android/app/google-services.json
```

### iOS
```
ios/tibetskayaClientApp/AppDelegate.swift
ios/tibetskayaClientApp/Info.plist
ios/tibetskayaClientApp/tibetskayaClientApp.entitlements
ios/GoogleService-Info.plist
```

### –û–±—â–∏–µ
```
src/services/pushNotifications.ts
src/assets/notificationIcon.png
index.js
```

## üöÄ –°–±–æ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Android

#### 1. –°–±–æ—Ä–∫–∞ APK
```bash
cd android
./gradlew clean
./gradlew assembleRelease
cd ..
```

#### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
# –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
adb uninstall com.tibetskayaclientapp

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–æ–≤–æ–µ
adb install android/app/build/outputs/apk/release/app-release.apk
```

#### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. **–î–∞–π—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ** –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–≤–∞–∂–Ω–æ!)
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–∞
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - ‚úÖ –ó–≤—É–∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è
   - ‚úÖ –í–∏–±—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
   - ‚úÖ –í–∞—à–∞ –∏–∫–æ–Ω–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
   - ‚úÖ –¶–≤–µ—Ç –∞–∫—Ü–µ–Ω—Ç–∞ —Ä–æ–∑–æ–≤—ã–π

### iOS

#### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
cd ios
pod install
cd ..
```

#### 2. –°–±–æ—Ä–∫–∞
```bash
# –î–ª—è development
npx react-native run-ios

# –ò–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ Xcode
open ios/tibetskayaClientApp.xcworkspace
```

#### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç—Å—è)
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Xcode
2. **Signing & Capabilities**
3. –î–æ–±–∞–≤—å—Ç–µ **Apple ID** –∞–∫–∫–∞—É–Ω—Ç
4. –í—ã–±–µ—Ä–∏—Ç–µ **Team**
5. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ capability **Push Notifications** –≤–∫–ª—é—á–µ–Ω
6. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ **Background Modes** ‚Üí **Remote notifications** –≤–∫–ª—é—á–µ–Ω

#### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (—Å–∏–º—É–ª—è—Ç–æ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç push)
2. –î–∞–π—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - ‚úÖ –ó–≤—É–∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è
   - ‚úÖ Badge —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è
   - ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

### Android
```bash
npx react-native log-android

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
adb logcat | grep -E "(FCM|Firebase|Notification|üî¥|üü¢)"
```

### iOS
```bash
npx react-native log-ios

# –ò–ª–∏ –≤ Xcode: View ‚Üí Debug Area ‚Üí Activate Console
```

## üì± –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏

### –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```
‚úÖ –§–æ–Ω–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
üîî –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π...
‚úÖ –ö–∞–Ω–∞–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π notifee —Å–æ–∑–¥–∞–Ω: orders_v2
üì± Android 13+: –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ POST_NOTIFICATIONS
‚úÖ Android: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ POST_NOTIFICATIONS –ø–æ–ª—É—á–µ–Ω–æ
‚úÖ Firebase: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω–æ
üì± FCM Token: eRMaGZFf...
üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ FCM —Ç–æ–∫–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä...
‚úÖ FCM —Ç–æ–∫–µ–Ω –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä —É—Å–ø–µ—à–Ω–æ
```

### –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (—Ñ–æ–Ω):
```
üî¥üî¥üî¥ –§–û–ù–û–í–û–ï –£–í–ï–î–û–ú–õ–ï–ù–ò–ï –ü–û–õ–£–ß–ï–ù–û! üî¥üî¥üî¥
üì¨ –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è: {...}
üìã Notification: {title: "...", body: "..."}
üì¶ Data: {newStatus: "...", orderId: "..."}
```

### –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–ø–µ—Ä–µ–¥–Ω–∏–π –ø–ª–∞–Ω):
```
üü¢üü¢üü¢ –£–í–ï–î–û–ú–õ–ï–ù–ò–ï –ù–ê –ü–ï–†–ï–î–ù–ï–ú –ü–õ–ê–ù–ï! üü¢üü¢üü¢
üì® –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: {...}
‚úÖ –õ–æ–∫–∞–ª—å–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞–Ω–æ (Android + iOS)
```

## ‚ö†Ô∏è –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ù–µ—Ç –∑–≤—É–∫–∞ –Ω–∞ Android

**–ü—Ä–∏—á–∏–Ω–∞:** –°—Ç–∞—Ä—ã–π –∫–∞–Ω–∞–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –±–µ–∑ –∑–≤—É–∫–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–¥–∞–ª–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é
2. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ APK
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–Ω–æ–≤–æ

**–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:**
```
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Üí tibetskayaClientApp ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è 
‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–∫–∞–∑–∞—Ö ‚Üí –í–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫
```

### –ù–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å –Ω–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ

**Android:**
```bash
adb uninstall com.tibetskayaclientapp
adb install -r android/app/build/outputs/apk/release/app-release.apk
```

**iOS:**
- –£–¥–∞–ª–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —á–µ—Ä–µ–∑ Xcode

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –Ω–∞ iOS

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. –¢–µ—Å—Ç–∏—Ä—É–µ—Ç–µ –Ω–∞ **—Ñ–∏–∑–∏—á–µ—Å–∫–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ** (–Ω–µ —Å–∏–º—É–ª—è—Ç–æ—Ä–µ)
2. Push Notifications capability –≤–∫–ª—é—á–µ–Ω –≤ Xcode
3. APNs —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ Firebase Console
4. Bundle ID —Å–æ–≤–ø–∞–¥–∞–µ—Ç: `com.tibetskayaclientapp`

### FCM —Ç–æ–∫–µ–Ω –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**
```
‚ö†Ô∏è userId –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, —Ç–æ–∫–µ–Ω –ù–ï –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä
```

**–†–µ—à–µ–Ω–∏–µ:** –¢–æ–∫–µ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `useAuth` —Ö—É–∫

## üé® –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏–∫–æ–Ω–æ–∫

### Android

**–ú–∞–ª–µ–Ω—å–∫–∞—è –∏–∫–æ–Ω–∫–∞ (—Å–ª–µ–≤–∞ –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏):**
```
android/app/src/main/res/drawable/ic_notification.png
```

**–ë–æ–ª—å—à–∞—è –∏–∫–æ–Ω–∫–∞ (—Å–ø—Ä–∞–≤–∞ –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏):**
```typescript
// src/services/pushNotifications.ts
largeIcon: require('../assets/your-icon.png')
```

### iOS

**–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–æ –≤–ª–æ–∂–µ–Ω–∏–∏:**
```typescript
// src/services/pushNotifications.ts
attachments: [
  {
    url: require('../assets/your-icon.png'),
    thumbnailHidden: false,
  },
]
```

## üîê Production –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### Android
APK —É–∂–µ –≥–æ—Ç–æ–≤ –∫ production (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç release keystore)

### iOS

1. –ò–∑–º–µ–Ω–∏—Ç–µ –≤ `tibetskayaClientApp.entitlements`:
```xml
<key>aps-environment</key>
<string>production</string>
```

2. –í Xcode –≤—ã–±–µ—Ä–∏—Ç–µ **Archive** –¥–ª—è App Store

3. –í Firebase Console –¥–æ–±–∞–≤—å—Ç–µ **APNs Production Certificate**

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ (—Å–º. –≤—ã—à–µ)
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–∞–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–Ω–∞–ª–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –¥—Ä—É–≥–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

